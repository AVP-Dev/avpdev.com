# Определяем сервисы (контейнеры)
services:
  # Название нашего сервиса
  astro-site:
    # Указываем, что образ нужно собрать из Dockerfile в текущей директории
    build: .
    # Имя контейнера для удобства
    container_name: my-astro-site
    # ИСПРАВЛЕНО: Пробрасываем порт 3000, который теперь слушает Node.js сервер
    ports:
      - "3000:3000"
    # ИЗМЕНЕНО: Лучшая практика - передавать переменные окружения напрямую в контейнер,
    # а не копировать .env файл в образ. Docker Compose возьмет их из .env файла
    # в той же директории, где вы запускаете docker-compose up
    environment:
      - BOT_TOKEN=${BOT_TOKEN}
      - CHAT_ID=${CHAT_ID}
      - TOPIC_ID=${TOPIC_ID}
    # Политика перезапуска: контейнер будет автоматически перезапускаться
    restart: unless-stopped
